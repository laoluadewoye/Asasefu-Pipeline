<div class="results-div">
    <h2>Completed Parses</h2>
    <div class="center-content">
        <button class="button-padding" (click)="refreshView()">Refresh View</button>
        @if (isRefreshing()) {
            <div class="success fade-in" animate.leave="fade-out">
                <p>Refreshing result menu...</p>
            </div>
        }
    </div>
    <div id="result-div-menu">
        <div class="results-unit-div" [class.red-background]="activeTab() === 'stories-and-chapters'" (click)="selectTab('stories-and-chapters')">
            <h3>Stories and Chapters</h3>
        </div>
        <div class="results-unit-div" [class.red-background]="activeTab() === 'story-metadata-only'" (click)="selectTab('story-metadata-only')">
            <h3>Story Metadata Only</h3>
        </div>
        <div class="results-unit-div" [class.red-background]="activeTab() === 'chapters-only'" (click)="selectTab('chapters-only')">
            <h3>Individual Chapters Only</h3>
        </div>
    </div>

    <!--https://www.w3schools.com/howto/howto_js_collapsible.asp-->
    <div id="result-div-content">
        @if (activeTab() === "stories-and-chapters") {
            <div id="result-div-stories-and-chapters" class="results-unit-div">
                @for(value of completedSessionMap().values(); track value) {
                    <p>{{ value.hash }}</p>
                }
            </div>
        }
        @if (activeTab() === "story-metadata-only") {
            <div id="result-div-story-metadata-only" class="results-unit-div">
                @if (parentLatestCompletedSessionId() !== "") {
                    <app-story-metadata [storyMetadataResultUnit]="getLatestStoryMetadataResultUnit()" [latestUnit]="true"/>
                }
                @for(value of storyMetadataMap().values(); track value) {
                    @if (value.id !== parentLatestCompletedSessionId()) {
                        <app-story-metadata [storyMetadataResultUnit]="value" [latestUnit]="false"/>
                    }
                }
            </div>
        }
        @if (activeTab() === "chapters-only") {
            <div id="result-div-chapters-only" class="results-unit-div">
                @for(value of chapterMap().values(); track value) {
                    <p>{{ value.nickname }}</p>
                }
            </div>
        }
    </div>
</div>
